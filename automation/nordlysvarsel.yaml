homeassistant:
  name: Home
  latitude: 59.95
  longitude: 10.75
  elevation: 108
  unit_system: metric
  time_zone: Europe/Oslo

frontend:
config:
http:
updater:
recorder:
history:
logbook:

#sun:

#mqtt:
#  embedded:

#sensor:
#  - platform: yr

#group: !include groups.yaml
# automation: !include automations.yaml

#alarm_control_panel:
#  - platform: manual_mqtt
#    state_topic: "home/alarm"
#    command_topic: "home/alarm/set"
#    code: 1234

binary_sensor:
  - platform: workday
    country: 'NO'
    name: 'today'

  - platform: workday
    country: 'NO'
    days_offset: 1
    name: 'tomorrow'

  - platform: workday
    country: 'NO'
    days_offset: 2
    name: 'the day after tomorrow'

  - platform: workday
    country: 'NO'
    days_offset: -1
    name: 'yesterday'


automation:
  - alias: Nordlysvarsel notification 1
    trigger:
      - platform: state
        entity_id: sensor.nordlysvarsel_1_time
    condition:
      # sun.elevation < -15
      - condition: numeric_state
        entity_id: sun.sun
        value_template: '{{ state.attributes.elevation }}'
        below: -15

      # month < may and month > august
      - condition: or
        conditions:
          - condition: template
            value_template: '{{ now().month < 5 }}'
          - condition: template
            value_template: '{{ now().month > 8 }}'

      # Only when not on vacation
      - condition: state
        entity_id: input_boolean.vacation_mode
        state: 'off'

      - condition: or
        conditions:
          - condition: and
            conditions:
              - condition: state
                entity_id: binary_sensor.workday_today
                state: 'off'
              - condition: or
                conditions:
                  - condition: time
                    before: '02:00:00'
                  - condition: time
                    after: '10:00:00'
            
          - condition: and
            conditions:
            - condition: state
              entity_id: binary_sensor.workday_today
              state: 'on'
            - condition: time
              after: '10:00:00'

      - condition: numeric_state
        entity_id: sensor.nordlysvarsel_1_time
        above: 3.5

      # Need clear sky
      - condition: or
        conditions:
          - condition: numeric_state
            entity_id: 'sensor.yr_symbol'
            above: 0
            below: 4
          - condition: numeric_state
            entity_id: 'sensor.yr_symbol'
            above: 100
            below: 104
    action:
      - service: notify.ios_lolphone_7
        data:
          title: 'Nordlysvarsel'
          message: "Det er sp√•dd {{ states('sensor.nordlysvarsel_1_time') }} KP den neste timen."
